<div class="alert {{ ("alert-info" if msg.reply_timestamp is not none else ("alert-light" if msg.ignored else "alert-danger")) }}">
  <div class="float-right">
    <a href="{{ url("contest", contest.id, "user", msg.participation.user.id, "edit") }}" title="{{ msg.participation.user.first_name }} {{ msg.participation.user.last_name }}">{{ msg.participation.user.username }}</a> &mdash; {{ msg.question_timestamp }}
  </div>

  <div class="font-weight-bold">{{ msg.subject }}</div>
  <pre>{{ msg.text }}</pre>

  {% if msg.reply_timestamp is not none %}
    <div class="notification_subject"><strong>Reply</strong>: {{ msg.reply_subject }}</div>
    <div class="notification_text preserve_line_breaks">{{ msg.reply_text }}</div>
  {% else %}
    <div class="font-italic">Not yet replied.</div>
  {% endif %}

  {% if admin.permission_all or admin.permission_messaging %}
    {% if msg.reply_timestamp is none %}
      <form class="float-right" action="{{ url("contest", contest.id, "question", msg.id, "ignore") }}" name="ignore{{ msg.id }}" method="POST">
        {{ xsrf_form_html|safe }}
        {% if not msg.ignored %}
        <input type="hidden" name="ignore" value="yes"/>
        <a href="javascript:void(0);" onclick="document.ignore{{ msg.id }}.submit();">Ignore</a>
        {% else %}
        <input type="hidden" name="ignore" value="no"/>
        <a href="javascript:void(0);" onclick="document.ignore{{ msg.id }}.submit();">Unignore</a>
        {% endif %}
      </form>
    {% endif %}
    <div class="reply_question_toggle">
      <a href="javascript:void(0);" onclick="return question_reply_toggle({{ index }}, this);">
        {% if msg.reply_timestamp is none %}
          Reply
        {% else %}
          Edit reply
        {% endif %}
      </a>
    </div>
    <div class="reply_question" style="display: none">
      <hr />
      <form class="reply_question_form" action="{{ url("contest", contest.id, "question", msg.id, "reply") }}" method="POST">
        {{ xsrf_form_html|safe }}
        Precompiled answer:
        <select class="form-control" name="reply_question_quick_answer" onchange="update_additional_answer({{ loop.index0 }}, this);">
          <option value="yes">Yes</option>
          <option value="no">No</option>
          <option value="answered">Answered in task description</option>
          <option value="invalid">Invalid question</option>
          <option value="nocomment">No comment</option>
          <option selected value="other">Other</option>
        </select>
        <br/>
        <div class="alternative_answer">
          Alternative answer:<br/>
          <textarea class="form-control" name="reply_question_text"></textarea><br/>
        </div>
        <input type="submit" value="Send" class="btn btn-success"/>
      </form>
    </div>
  {% endif %}
</div>
